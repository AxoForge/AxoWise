<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Documentation | Cytokine Graph DB</title>
<meta name="generator" content="Jekyll v3.7.3" />
<meta property="og:title" content="Documentation" />
<meta name="author" content="Borna Bešić" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Prerequisites conda installed PostgreSQL server instance running (with the STRING schema dumps loaded) Neo4j server instance running" />
<meta property="og:description" content="Prerequisites conda installed PostgreSQL server instance running (with the STRING schema dumps loaded) Neo4j server instance running" />
<link rel="canonical" href="https://bornabesic.github.io/cytokine-graph-db/documentation" />
<meta property="og:url" content="https://bornabesic.github.io/cytokine-graph-db/documentation" />
<meta property="og:site_name" content="Cytokine Graph DB" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-11-18T00:00:00+01:00" />
<script type="application/ld+json">
{"description":"Prerequisites conda installed PostgreSQL server instance running (with the STRING schema dumps loaded) Neo4j server instance running","author":{"@type":"Person","name":"Borna Bešić"},"@type":"BlogPosting","url":"https://bornabesic.github.io/cytokine-graph-db/documentation","headline":"Documentation","dateModified":"2018-11-18T00:00:00+01:00","datePublished":"2018-11-18T00:00:00+01:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://bornabesic.github.io/cytokine-graph-db/documentation"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/cytokine-graph-db/assets/main.css"><link type="application/atom+xml" rel="alternate" href="https://bornabesic.github.io/cytokine-graph-db/feed.xml" title="Cytokine Graph DB" /></head>
<body><header class="site-header" role="banner">

    <div class="wrapper"><a class="site-title" rel="author" href="/cytokine-graph-db/">Cytokine Graph DB</a><nav class="site-nav">
          <input type="checkbox" id="nav-trigger" class="nav-trigger" />
          <label for="nav-trigger">
            <span class="menu-icon">
              <svg viewBox="0 0 18 15" width="18px" height="15px">
                <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
              </svg>
            </span>
          </label>
          <div class="trigger"><a class="page-link" href="/cytokine-graph-db/graph-db-scheme">Graph Database Scheme</a><a class="page-link" href="/cytokine-graph-db/">Workflow</a><a class="page-link" href="/cytokine-graph-db/assets/main.css"></a><a class="page-link" href="/cytokine-graph-db/notebooks.html">Notebooks</a><a class="page-link" href="/cytokine-graph-db/papers">Papers</a><a class="page-link" href="/cytokine-graph-db/TODO">TODO</a><a class="page-link" href="/cytokine-graph-db/feed.xml"></a></div>
        </nav></div>
  </header><main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Documentation</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2018-11-18T00:00:00+01:00" itemprop="datePublished">Nov 18, 2018
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <h2 id="prerequisites">Prerequisites</h2>
<ul>
  <li><a href="https://conda.io/docs/">conda</a> installed</li>
  <li><a href="https://www.postgresql.org/">PostgreSQL</a> server instance running (with the <a href="index">STRING schema dumps</a> loaded)</li>
  <li><a href="https://neo4j.com/">Neo4j</a> server instance running</li>
</ul>

<h2 id="setting-up-the-environment">Setting up the environment</h2>
<ol>
  <li>
    <p>Clone the GitHub repository</p>

    <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code> git clone https://github.com/BackofenLab/cytokine-graph-db.git
</code></pre></div>    </div>
  </li>
  <li>
    <p>Create a conda environment (from <strong>conda_env.yml</strong>)</p>

    <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code> make env
</code></pre></div>    </div>
  </li>
  <li>
    <p>Activate the conda environment</p>

    <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code> conda activate cgdb
</code></pre></div>    </div>
  </li>
</ol>

<h2 id="running-the-unit-tests">Running the unit tests</h2>

<p>Unit tests assume the following local configuration:</p>
<ul>
  <li>Authentication mode for PostgreSQL user <em>postgres</em> is set to <em>trust</em>
(in <strong>pg_hba.conf</strong>; read more <a href="https://www.postgresql.org/docs/9.6/static/auth-pg-hba-conf.html">here</a>)</li>
</ul>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>make run_tests
</code></pre></div></div>

<h2 id="translating-string-postgresql-database-to-neo4j-graph-database">Translating STRING PostgreSQL database to Neo4j graph database</h2>
<ol>
  <li>
    <p>Provide credentials for accessing the databases</p>

    <ul>
      <li>
        <p>Create <strong>credentials.json</strong> file in the root directory of the cloned repository. The format should be the following:</p>

        <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">  </span><span class="p">{</span><span class="w">
      </span><span class="s2">"postgres"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"host"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;hostname&gt;"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"port"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;port&gt;"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"database"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;database name&gt;"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"user"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;username&gt;"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"pw"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;password&gt;"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"neo4j"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"host"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;hostname&gt;"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"port"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;port&gt;"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"pw"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;password&gt;"</span><span class="w">
      </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span></code></pre></div>        </div>
        <p>One credentials file is already available for tesing at <em>test/credentials.test.json</em>.</p>
      </li>
    </ul>
  </li>
  <li>
    <p>Run the Python script (<strong>translate_db.py</strong>)</p>

    <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code> python translate_db.py
</code></pre></div>    </div>

    <p>Available arguments:</p>

    <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="nt">--credentials</span> CREDENTIALS
                         Path to the credentials JSON file that will be used
                         <span class="o">(</span>default: credentials.json<span class="o">)</span>
 <span class="nt">--kegg_organism_id</span> KEGG_ORGANISM_ID
                         KEGG organism ID <span class="o">(</span>default: hsa<span class="o">)</span>
 <span class="nt">--species_name</span> SPECIES_NAME
                         Species name <span class="o">(</span>default: Homo sapiens<span class="o">)</span>
 <span class="nt">--protein_list</span> PROTEIN_LIST
                         Path to the file containing protein Ensembl IDs
                         <span class="o">(</span>default: None<span class="o">)</span>
 <span class="nt">--combined_score_threshold</span> COMBINED_SCORE_THRESHOLD
                         Threshold above which the associations between
                         proteins will be considered <span class="o">(</span>default: None<span class="o">)</span>
 <span class="nt">--skip_drugs</span> SKIP_DRUGS
                         Do not add drugs to the resulting graph database
                         <span class="o">(</span>default: False<span class="o">)</span>
 <span class="nt">--skip_compounds</span> SKIP_COMPOUNDS
                         Do not add compounds to the resulting graph database
                         <span class="o">(</span>default: False<span class="o">)</span>
 <span class="nt">--skip_diseases</span> SKIP_DISEASES
                         Do not add diseases to the resulting graph database
                         <span class="o">(</span>default: False<span class="o">)</span>

</code></pre></div>    </div>

    <p><span style="color:red; font-size: small;">Redundancy regarding the specification of both species ID and name should be resolved in the future.</span></p>
  </li>
</ol>

<h1 id="example">Example:</h1>

<p>The following command builds a Neo4j database out of the mouse proteins and associations between them that have the combined score greater than 0.750.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python translate_db.py <span class="nt">--credentials</span> <span class="nb">test</span>/credentials.test.json <span class="se">\</span>
                       <span class="nt">--kegg_organism_id</span> <span class="s2">"mmu"</span> <span class="se">\</span>
                       <span class="nt">--species_name</span> <span class="s2">"Mus musculus"</span> <span class="se">\</span>
                       <span class="nt">--combined_score_threshold</span> 750
</code></pre></div></div>

<p>Output:</p>
<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Cleaning the old data from Neo4j database...
Creating compounds...
3460
Creating diseases...
0
Creating drugs...
0
Creating classes and class hierarchy...
43
Creating pathways and connecting them to classes...
326
Connecting compounds and pathways...
5984
Connecting diseases and pathways...
326
Connecting drugs and pathways...
326
Creating proteins...
22668
Creating protein - protein associations...
1322
Creating protein - protein actions...
0
Connecting proteins and pathways...
27750
Done!
</code></pre></div></div>

<h2 id="downloading-kegg-data-for-a-different-species">Downloading KEGG data for a different species</h2>

<p>Currently, only the KEGG data for human (<em>Homo sapiens</em>) and mouse (<em>Mus musculus</em>) is available in the project repository (<em>KEGG / data</em>). To add another species’ data, use the following steps:</p>

<ol>
  <li>
    <p>Change the working directory to <em>KEGG /</em></p>

    <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="nb">cd </span>KEGG/
</code></pre></div>    </div>
  </li>
  <li>
    <p>Run the download script:</p>

    <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code> python download.py
</code></pre></div>    </div>

    <p>Available arguments:</p>

    <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="nt">--kegg_organism_id</span> KEGG_ORGANISM_ID
                         Download KEGG pathways only <span class="k">for </span>this organism
                         <span class="o">(</span>default: hsa<span class="o">)</span>
 <span class="nt">--string_organism_id</span> STRING_ORGANISM_ID
                         Map KEGG pathways to this STRING organism <span class="o">(</span>default:
                         9606<span class="o">)</span>

</code></pre></div>    </div>

    <p><span style="color:red; font-size: small;">Redundancy regarding the specification of multiple species IDs should be resolved in the future.</span></p>
  </li>
</ol>

<h1 id="example-1">Example:</h1>

<p>To download KEGG data for chimpanzee (<em>Pan troglodytes</em>), run the following command:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python download.py <span class="nt">--kegg_organism_id</span> <span class="s2">"ptr"</span> <span class="se">\</span>
                   <span class="nt">--string_organism_id</span> <span class="s2">"9598"</span>
</code></pre></div></div>

<p>Output:</p>
<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Downloading pathways <span class="k">for</span>: ptr
<span class="o">[</span>1 / 326] Glycolysis / Gluconeogenesis
	Genes: 69
	10 gene<span class="o">(</span>s<span class="o">)</span> could not be mapped to STRING external ID!
<span class="o">[</span>2 / 326] Citrate cycle <span class="o">(</span>TCA cycle<span class="o">)</span>
	Genes: 30
	4 gene<span class="o">(</span>s<span class="o">)</span> could not be mapped to STRING external ID!
<span class="o">[</span>3 / 326] Pentose phosphate pathway
	Genes: 30
	9 gene<span class="o">(</span>s<span class="o">)</span> could not be mapped to STRING external ID!
...
</code></pre></div></div>

  </div><a class="u-url" href="/cytokine-graph-db/documentation" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/cytokine-graph-db/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Cytokine Graph DB</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Borna Bešić</li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/bornabesic"><svg class="svg-icon"><use xlink:href="/cytokine-graph-db/assets/minima-social-icons.svg#github"></use></svg> <span class="username">bornabesic</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p></p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
