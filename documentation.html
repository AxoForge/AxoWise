<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Documentation | Protein Graph Database</title>
<meta name="generator" content="Jekyll v3.7.3" />
<meta property="og:title" content="Documentation" />
<meta name="author" content="Borna Bešić" />
<meta property="og:locale" content="en_US" />
<link rel="canonical" href="https://backofenlab.github.io/protein-graph-database/documentation" />
<meta property="og:url" content="https://backofenlab.github.io/protein-graph-database/documentation" />
<meta property="og:site_name" content="Protein Graph Database" />
<script type="application/ld+json">
{"author":{"@type":"Person","name":"Borna Bešić"},"@type":"WebPage","url":"https://backofenlab.github.io/protein-graph-database/documentation","headline":"Documentation","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/protein-graph-database/assets/main.css"><link type="application/atom+xml" rel="alternate" href="https://backofenlab.github.io/protein-graph-database/feed.xml" title="Protein Graph Database" /></head>
<body><header class="site-header" role="banner">

    <div class="wrapper"><a class="site-title" rel="author" href="/protein-graph-database/">Protein Graph Database</a><nav class="site-nav" style="padding-left: 20px;">
          <input type="checkbox" id="nav-trigger" class="nav-trigger" />
          <label for="nav-trigger">
            <span class="menu-icon">
              <svg viewBox="0 0 18 15" width="18px" height="15px">
                <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
              </svg>
            </span>
          </label>
          <div class="trigger"><a class="page-link" href="/protein-graph-database/documentation">Documentation</a><a class="page-link" href="/protein-graph-database/graph-db-scheme">Graph Database Scheme</a><a class="page-link" href="/protein-graph-database/">Workflow</a><a class="page-link" href="/protein-graph-database/assets/main.css"></a><a class="page-link" href="/protein-graph-database/papers">Papers</a><a class="page-link" href="/protein-graph-database/feed.xml"></a></div>
        </nav></div>
  </header><main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post">

  <header class="post-header">
    <h1 class="post-title">Documentation</h1>
  </header>

  <div class="post-content">
    <p><a href="#prerequisites">Prerequisites</a><br />
<a href="#setting-up-the-environment">Setting up the environment</a><br />
<a href="#running-unit-tests">Running unit tests</a><br />
<a href="#downloading-kegg-data-for-a-certain-species">Downloading KEGG data for a certain species</a><br />
<a href="#building-a-neo4j-graph-database">Building a Neo4j graph database</a></p>

<p><br /></p>
<hr />

<p><br /></p>

<h2 id="prerequisites">Prerequisites</h2>
<ul>
  <li><a href="https://conda.io/docs/">conda</a> installed</li>
  <li><a href="https://www.postgresql.org/">PostgreSQL</a> server instance running (with the <a href="index#1-collect-the-data">STRING schema dumps</a> loaded)</li>
  <li><a href="https://neo4j.com/">Neo4j</a> server instance running</li>
</ul>

<h2 id="setting-up-the-environment">Setting up the environment</h2>
<ol>
  <li>
    <p>Clone the GitHub repository</p>

    <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code> git clone https://github.com/BackofenLab/protein-graph-database.git
</code></pre></div>    </div>
  </li>
  <li>
    <p>Create a conda environment (from <strong>conda_env.yml</strong>)</p>

    <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code> make env
</code></pre></div>    </div>
  </li>
  <li>
    <p>Activate the conda environment</p>

    <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code> conda activate pgdb
</code></pre></div>    </div>
  </li>
</ol>

<h2 id="running-unit-tests">Running unit tests</h2>

<p>Unit tests assume the following local configuration:</p>
<ul>
  <li>Authentication mode for PostgreSQL user <em>postgres</em> is set to <em>trust</em>
(in <strong>pg_hba.conf</strong>; read more <a href="https://www.postgresql.org/docs/9.6/static/auth-pg-hba-conf.html">here</a>)</li>
</ul>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>make test
</code></pre></div></div>

<h2 id="downloading-kegg-data-for-a-certain-species">Downloading KEGG data for a certain species</h2>

<p>Currently, only the KEGG data for human (<em>Homo sapiens</em>) and mouse (<em>Mus musculus</em>) is available in the project repository (<em>KEGG / data</em>). To add another species data, use the following steps:</p>

<ol>
  <li>
    <p>Change the working directory to <em>KEGG /</em></p>

    <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="nb">cd </span>KEGG/
</code></pre></div>    </div>
  </li>
  <li>
    <p>Run the download script:</p>

    <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code> python download.py species_name
</code></pre></div>    </div>

    <p>Positional arguments:</p>

    <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code> species_name  Species name <span class="o">(</span>e.g. Homo sapiens / human<span class="o">)</span>
</code></pre></div>    </div>
  </li>
</ol>

<p style="color: red;">When specifying the species name, please be as precise as possible. Otherwise, the scripts may yield an unwanted result. Fuzzy search is still not perfect.</p>

<h1 id="example">Example:</h1>

<p>To download KEGG data for chimpanzee (<em>Pan troglodytes</em>), run the following command:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python download.py <span class="nt">--species_name</span> <span class="s2">"chimpanzee"</span>
</code></pre></div></div>

<p>Output:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Downloading KEGG data for Pan troglodytes (chimpanzee).
Downloading pathways for: ptr
[1 / 326] Glycolysis / Gluconeogenesis
	Genes: 69
	10 gene(s) could not be mapped to STRING external ID!
[2 / 326] Citrate cycle (TCA cycle)
	Genes: 30
	4 gene(s) could not be mapped to STRING external ID!
[3 / 326] Pentose phosphate pathway
	Genes: 30
	9 gene(s) could not be mapped to STRING external ID!
...
</code></pre></div></div>

<h2 id="building-a-neo4j-graph-database">Building a Neo4j graph database</h2>
<ol>
  <li>
    <p>Provide credentials for accessing the databases</p>

    <ul>
      <li>
        <p>Create <strong>credentials.yml</strong> file in the root directory of the cloned repository. The format should be the following:</p>

        <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="c1"># PostgreSQL Database Credentials</span>
  <span class="na">postgres</span><span class="pi">:</span>
      <span class="na">host</span><span class="pi">:</span> <span class="s">&lt;hostname&gt;</span>
      <span class="na">port</span><span class="pi">:</span> <span class="s">&lt;port&gt;</span>
      <span class="na">database</span><span class="pi">:</span> <span class="s">&lt;database name&gt;</span>
      <span class="na">user</span><span class="pi">:</span> <span class="s">&lt;username&gt;</span>
      <span class="na">pw</span><span class="pi">:</span> <span class="s">&lt;password&gt;</span>

  <span class="c1"># Neo4j Database Credentials</span>
  <span class="na">neo4j</span><span class="pi">:</span>
      <span class="na">host</span><span class="pi">:</span> <span class="s">&lt;hostname&gt;</span>
      <span class="na">port</span><span class="pi">:</span> <span class="s">&lt;port&gt;</span>
      <span class="na">pw</span><span class="pi">:</span> <span class="s">&lt;password&gt;</span>
</code></pre></div>        </div>
        <p>One credentials file is already available for tesing at <em>test/credentials.test.yml</em>.</p>
      </li>
    </ul>
  </li>
  <li>
    <p>Run the Python script (<strong>build_graph_db.py</strong>)</p>

    <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code> python build_graph_db.py
</code></pre></div>    </div>

    <p>Available arguments:</p>

    <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="nt">--credentials</span> CREDENTIALS
                         Path to the credentials YAML file that will be used
                         <span class="o">(</span>default: credentials.yml<span class="o">)</span>
 <span class="nt">--species_name</span> SPECIES_NAME
                         Species name <span class="o">(</span>default: Homo sapiens<span class="o">)</span>
 <span class="nt">--protein_list</span> PROTEIN_LIST
                         Path to the file containing protein Ensembl IDs
                         <span class="o">(</span>default: None<span class="o">)</span>
 <span class="nt">--combined_score_threshold</span> COMBINED_SCORE_THRESHOLD
                         Threshold above which the associations between
                         proteins will be considered <span class="o">(</span>default: None<span class="o">)</span>
 <span class="nt">--skip_actions</span> SKIP_ACTIONS
                         Do not add protein - protein actions to the resulting
                         graph database <span class="o">(</span>default: True<span class="o">)</span>
 <span class="nt">--skip_drugs</span> SKIP_DRUGS
                         Do not add drugs to the resulting graph database
                         <span class="o">(</span>default: False<span class="o">)</span>
 <span class="nt">--skip_compounds</span> SKIP_COMPOUNDS
                         Do not add compounds to the resulting graph database
                         <span class="o">(</span>default: False<span class="o">)</span>
 <span class="nt">--skip_diseases</span> SKIP_DISEASES
                         Do not add diseases to the resulting graph database
                         <span class="o">(</span>default: False<span class="o">)</span>
 <span class="nt">--keep_old_database</span> KEEP_OLD_DATABASE
                         Do not overwrite the existing Neo4j graph database
                         <span class="o">(</span>default: False<span class="o">)</span>
</code></pre></div>    </div>
  </li>
</ol>

<h1 id="example-1">Example:</h1>

<p>The following command builds a Neo4j database out of the mouse proteins and associations between them that have the combined score greater than 0.750.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python build_graph_db.py <span class="nt">--credentials</span> <span class="nb">test</span>/credentials.test.yml <span class="se">\</span>
                       <span class="nt">--species_name</span> <span class="s2">"mus musculus"</span> <span class="se">\</span>
                       <span class="nt">--combined_score_threshold</span> 750
</code></pre></div></div>

<p>Output:</p>
<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Cleaning the old data from Neo4j database...
Creating compounds...
3460
Creating diseases...
0
Creating drugs...
0
Creating classes and class hierarchy...
43
Creating pathways and connecting them to classes...
326
Connecting compounds and pathways...
5984
Connecting diseases and pathways...
326
Connecting drugs and pathways...
326
Creating proteins...
22668
Creating protein - protein associations...
1322
Creating protein - protein actions...
0
Connecting proteins and pathways...
27750
Done!
</code></pre></div></div>

  </div>

</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/protein-graph-database/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Protein Graph Database</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Borna Bešić</li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/bornabesic"><svg class="svg-icon"><use xlink:href="/protein-graph-database/assets/minima-social-icons.svg#github"></use></svg> <span class="username">bornabesic</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p></p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
