<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Documentation | Protein Graph Database</title>
<meta name="generator" content="Jekyll v3.7.3" />
<meta property="og:title" content="Documentation" />
<meta name="author" content="Borna Bešić" />
<meta property="og:locale" content="en_US" />
<link rel="canonical" href="https://backofenlab.github.io/protein-graph-database/documentation" />
<meta property="og:url" content="https://backofenlab.github.io/protein-graph-database/documentation" />
<meta property="og:site_name" content="Protein Graph Database" />
<script type="application/ld+json">
{"author":{"@type":"Person","name":"Borna Bešić"},"@type":"WebPage","url":"https://backofenlab.github.io/protein-graph-database/documentation","headline":"Documentation","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/protein-graph-database/assets/main.css"><link type="application/atom+xml" rel="alternate" href="https://backofenlab.github.io/protein-graph-database/feed.xml" title="Protein Graph Database" /></head>
<body><header class="site-header" role="banner">

    <div class="wrapper"><a class="site-title" rel="author" href="/protein-graph-database/">Protein Graph Database</a><nav class="site-nav" style="padding-left: 20px;">
          <input type="checkbox" id="nav-trigger" class="nav-trigger" />
          <label for="nav-trigger">
            <span class="menu-icon">
              <svg viewBox="0 0 18 15" width="18px" height="15px">
                <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
              </svg>
            </span>
          </label>
          <div class="trigger"><a class="page-link" href="/protein-graph-database/documentation">Documentation</a><a class="page-link" href="/protein-graph-database/graph-db-scheme">Graph Database Scheme</a><a class="page-link" href="/protein-graph-database/">Workflow</a><a class="page-link" href="/protein-graph-database/assets/main.css"></a><a class="page-link" href="/protein-graph-database/papers">Papers</a><a class="page-link" href="/protein-graph-database/feed.xml"></a></div>
        </nav></div>
  </header><main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post">

  <header class="post-header">
    <h1 class="post-title">Documentation</h1>
  </header>

  <div class="post-content">
    <p><a href="#prerequisites">Prerequisites</a><br />
<a href="#setting-up-the-environment">Setting up the environment</a><br />
<a href="#running-unit-tests">Running unit tests</a><br />
<a href="#downloading-kegg-data-for-a-certain-species">Downloading KEGG data for a certain species</a><br />
<a href="#building-a-neo4j-graph-database">Building a Neo4j graph database</a><br />
<a href="#running-the-server">Running the server</a><br />
<a href="#starting-the-latest-deployed-docker-containers">Starting the latest deployed Docker container(s)</a><br />
<a href="#querying-the-neo4j-database">Querying the Neo4j database</a></p>

<p><br /></p>
<hr />

<p><br /></p>

<h2 id="prerequisites">Prerequisites</h2>
<ul>
  <li><a href="https://conda.io/docs/">conda</a> installed</li>
  <li><a href="https://www.postgresql.org/">PostgreSQL</a> server instance running (with the <a href="index#1-collect-the-data">STRING schema dumps</a> loaded)</li>
  <li><a href="https://neo4j.com/">Neo4j</a> server instance running</li>
</ul>

<h2 id="setting-up-the-environment">Setting up the environment</h2>
<ol>
  <li>
    <p>Clone the GitHub repository</p>

    <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code> git clone https://github.com/BackofenLab/protein-graph-database.git
 <span class="nb">cd </span>protein-graph-database/
</code></pre></div>    </div>
  </li>
  <li>
    <p>Create a conda environment (<a href="https://github.com/BackofenLab/protein-graph-database/blob/master/environment.yml">environment.yml</a>)</p>

    <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code> make env
</code></pre></div>    </div>
  </li>
  <li>
    <p>Activate the conda environment</p>

    <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code> conda activate pgdb
</code></pre></div>    </div>
  </li>
</ol>

<h2 id="running-unit-tests">Running unit tests</h2>

<p>Unit tests assume the following local configuration:</p>
<ul>
  <li>
    <p>Authentication mode for PostgreSQL user <em>postgres</em> is set to <em>trust</em>
(in <strong>pg_hba.conf</strong>; read more <a href="https://www.postgresql.org/docs/9.6/static/auth-pg-hba-conf.html">here</a>)</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  make test
</code></pre></div>    </div>
  </li>
</ul>

<h2 id="downloading-kegg-data-for-a-certain-species">Downloading KEGG data for a certain species</h2>

<p>Currently, only the KEGG data for human (<em>Homo sapiens</em>) and mouse (<em>Mus musculus</em>) is available in the project repository (<em>KEGG / data</em>). To add another species data, use the following steps:</p>

<ol>
  <li>
    <p>Change the working directory to <em>KEGG /</em></p>

    <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="nb">cd </span>KEGG/
</code></pre></div>    </div>
  </li>
  <li>
    <p>Run the download script:</p>

    <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code> python download.py species_name
</code></pre></div>    </div>

    <p>Positional arguments:</p>

    <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code> species_name  Species name <span class="o">(</span>e.g. Homo sapiens / human<span class="o">)</span>
</code></pre></div>    </div>
  </li>
</ol>

<p style="color: red;">When specifying the species name, please be as precise as possible. Otherwise, the scripts may yield an unwanted result. Fuzzy search is still not perfect.</p>

<h1 id="example">Example:</h1>

<p>To download KEGG data for chimpanzee (<em>Pan troglodytes</em>), run the following command:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python download.py <span class="nt">--species_name</span> <span class="s2">"chimpanzee"</span>
</code></pre></div></div>

<p>Output:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Downloading KEGG data for Pan troglodytes (chimpanzee).
Downloading pathways for: ptr
[1 / 326] Glycolysis / Gluconeogenesis
    Genes: 69
    10 gene(s) could not be mapped to STRING external ID!
[2 / 326] Citrate cycle (TCA cycle)
    Genes: 30
    4 gene(s) could not be mapped to STRING external ID!
[3 / 326] Pentose phosphate pathway
    Genes: 30
    9 gene(s) could not be mapped to STRING external ID!
...
</code></pre></div></div>

<h2 id="building-a-neo4j-graph-database">Building a Neo4j graph database</h2>
<ol>
  <li>
    <p>Provide credentials for accessing the databases</p>

    <ul>
      <li>
        <p>Create <strong>credentials.yml</strong> file in the root directory of the cloned repository. The format should be the following:</p>

        <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="c1"># PostgreSQL Database Credentials</span>
  <span class="na">postgres</span><span class="pi">:</span>
      <span class="na">host</span><span class="pi">:</span> <span class="s">&lt;hostname&gt;</span>
      <span class="na">port</span><span class="pi">:</span> <span class="s">&lt;port&gt;</span>
      <span class="na">database</span><span class="pi">:</span> <span class="s">&lt;database name&gt;</span>
      <span class="na">user</span><span class="pi">:</span> <span class="s">&lt;username&gt;</span>
      <span class="na">pw</span><span class="pi">:</span> <span class="s">&lt;password&gt;</span>

  <span class="c1"># Neo4j Database Credentials</span>
  <span class="na">neo4j</span><span class="pi">:</span>
      <span class="na">host</span><span class="pi">:</span> <span class="s">&lt;hostname&gt;</span>
      <span class="na">port</span><span class="pi">:</span> <span class="s">&lt;port&gt;</span>
      <span class="na">pw</span><span class="pi">:</span> <span class="s">&lt;password&gt;</span>
</code></pre></div>        </div>
        <p>One credentials file is already available for tesing at <em>test/credentials.test.yml</em>.</p>
      </li>
    </ul>
  </li>
  <li>
    <p>Run the Python script (<strong>build_graph_db.py</strong>)</p>

    <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code> python build_graph_db.py
</code></pre></div>    </div>

    <p>Available arguments:</p>

    <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="nt">--credentials</span> CREDENTIALS
                         Path to the credentials YAML file that will be used
                         <span class="o">(</span>default: credentials.yml<span class="o">)</span>
 <span class="nt">--species_name</span> SPECIES_NAME
                         Species name <span class="o">(</span>default: Homo sapiens<span class="o">)</span>
 <span class="nt">--protein_list</span> PROTEIN_LIST
                         Path to the file containing protein Ensembl IDs
                         <span class="o">(</span>default: None<span class="o">)</span>
 <span class="nt">--combined_score_threshold</span> COMBINED_SCORE_THRESHOLD
                         Threshold above which the associations between
                         proteins will be considered <span class="o">(</span>default: None<span class="o">)</span>
 <span class="nt">--skip_actions</span> SKIP_ACTIONS
                         Do not add protein - protein actions to the resulting
                         graph database <span class="o">(</span>default: True<span class="o">)</span>
 <span class="nt">--skip_drugs</span> SKIP_DRUGS
                         Do not add drugs to the resulting graph database
                         <span class="o">(</span>default: False<span class="o">)</span>
 <span class="nt">--skip_compounds</span> SKIP_COMPOUNDS
                         Do not add compounds to the resulting graph database
                         <span class="o">(</span>default: False<span class="o">)</span>
 <span class="nt">--skip_diseases</span> SKIP_DISEASES
                         Do not add diseases to the resulting graph database
                         <span class="o">(</span>default: False<span class="o">)</span>
 <span class="nt">--keep_old_database</span> KEEP_OLD_DATABASE
                         Do not overwrite the existing Neo4j graph database
                         <span class="o">(</span>default: False<span class="o">)</span>
</code></pre></div>    </div>
  </li>
</ol>

<h1 id="example-1">Example:</h1>

<p>The following command builds a Neo4j database out of the mouse proteins and associations between them that have the combined score greater than 0.750.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python build_graph_db.py <span class="nt">--credentials</span> <span class="nb">test</span>/credentials.test.yml <span class="se">\</span>
                       <span class="nt">--species_name</span> <span class="s2">"mus musculus"</span> <span class="se">\</span>
                       <span class="nt">--combined_score_threshold</span> 750
</code></pre></div></div>

<p>Output:</p>
<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Cleaning the old data from Neo4j database...
Creating compounds...
3460
Creating diseases...
0
Creating drugs...
0
Creating classes and class hierarchy...
43
Creating pathways and connecting them to classes...
326
Connecting compounds and pathways...
5984
Connecting diseases and pathways...
326
Connecting drugs and pathways...
326
Creating proteins...
22668
Creating protein - protein associations...
1322
Creating protein - protein actions...
0
Connecting proteins and pathways...
27750
Done!
</code></pre></div></div>

<h2 id="running-the-server">Running the server</h2>

<p>Starting a server that exposes a REST API and serves the frontend files is as easy as running:</p>
<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python server.py
</code></pre></div></div>
<p>The output should resemble the following:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> * Serving Flask app "server" (lazy loading)
 * Environment: production
   WARNING: Do not use the development server in a production environment.
   Use a production WSGI server instead.
 * Debug mode: on
 * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
 ...

</code></pre></div></div>

<p>The server can then be accessed locally @ <a href="http://127.0.0.1:5000/">http://127.0.0.1:5000/</a></p>

<p style="color: red;">This is a development server, and it is not by any means ready to be used in production.</p>

<h2 id="starting-the-latest-deployed-docker-containers">Starting the latest deployed Docker container(s)</h2>

<p>Definition of image names and how they are connected can be found in <a href="https://github.com/BackofenLab/protein-graph-database/blob/master/docker-compose.yml">docker-compose.yml</a>.</p>

<p>Make sure that you have <code class="highlighter-rouge">docker</code> and <code class="highlighter-rouge">docker-compose</code> installed. For Debian-based distributions, they are available via APT:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>apt install docker.io docker-compose
</code></pre></div></div>

<p>Database and server can be started running the following command in the root directory of our repository:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker-compose up
</code></pre></div></div>

<p>The web application is accessible @ <a href="http://localhost:5000/1">http://localhost:5000/</a></p>

<p>After exiting, it is also recommended to clean up:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker-compose down
</code></pre></div></div>

<h2 id="querying-the-neo4j-database">Querying the Neo4j database</h2>

<p>Make sure you are already familiar and comfortable with <a href="https://neo4j.com/developer/cypher-query-language/">Cypher and its syntax</a>.</p>

<h1 id="command-line-interface-cli">Command line interface (CLI)</h1>

<p>Our Neo4j command line interface (CLI) is available in the form of a Python script and can be started (assuming the file is executable) with:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./pgdb-cli
</code></pre></div></div>

<p>Prompt (waiting for a query from the standard input):</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">===</span> Protein Graph Database CLI <span class="o">===</span>
<span class="o">&gt;</span>
</code></pre></div></div>

<p>After a query is typed in, one should press <code class="highlighter-rouge">Ctrl+D</code> (EOF) to send the query to the Neo4j database.</p>

<h1 id="cypher-queries">Cypher queries</h1>

<p>Queries in this section use <code class="highlighter-rouge">name</code> property for matching since it is more convenient for a user. In order to match the nodes unambiguously, one should use <code class="highlighter-rouge">id</code> property instead.</p>

<p>Usually there are multiple nodes matching a given name. That is the reason we use fuzzy search and give a user the final decision.</p>

<p>Keeping <a href="graph-db-scheme">our database graph scheme</a> in mind, queries are more or less straightforward and intuitive. The following examples cover various scenarios and should be enough to start writing basic to intermediate queries.</p>

<h1 id="postprocessing">Postprocessing</h1>

<p>The Neo4j CLI contains a handful of postprocessing functions. These functions automatically split the returned data into separate tables (i.e. pandas DataFrames) suitable for writing to a CSV file. Other data formats are put into a single table as they are.</p>

<p>For each output table, the user is prompted whether she/he wants to save the table.</p>

<p>Currently, the following postprocessing is supported:</p>

<p><strong>Protein interactions</strong></p>
<ul>
  <li>
    <p>Expected RETURN format</p>

    <table>
      <thead>
        <tr>
          <th>Column name</th>
          <th>Type</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>source</td>
          <td>Protein</td>
        </tr>
        <tr>
          <td>target</td>
          <td>Protein</td>
        </tr>
        <tr>
          <td>score</td>
          <td>number (representing the strength of the interaction)</td>
        </tr>
      </tbody>
    </table>
  </li>
  <li>
    <p>Output tables:</p>

    <table>
      <thead>
        <tr>
          <th>nodes</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>id</td>
        </tr>
        <tr>
          <td>external_id</td>
        </tr>
        <tr>
          <td>name</td>
        </tr>
        <tr>
          <td>description</td>
        </tr>
        <tr>
          <td>species_id</td>
        </tr>
      </tbody>
    </table>

    <table>
      <thead>
        <tr>
          <th>edges</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>source</td>
        </tr>
        <tr>
          <td>target</td>
        </tr>
        <tr>
          <td>score</td>
        </tr>
      </tbody>
    </table>
  </li>
  <li>
    <p>Example:</p>

    <p>Best scoring 100 proteins associated with CCL5</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  WITH "CCL5" as protein_name
  MATCH (source:Protein {name: protein_name})-[a:ASSOCIATION]-(target:Protein)
  RETURN source, a.combined AS score, target
  ORDER BY score DESC
  LIMIT 100
</code></pre></div>    </div>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  [nodes]
       id               external_id    name                                        description species_id
  1847396      9606.ENSP00000293272    CCL5  Chemokine (C-C motif) ligand 5; Chemoattractan...       9606
  1847342      9606.ENSP00000292303    CCR5  Chemokine (C-C motif) receptor 5 (gene/pseudog...       9606
  2100220  10090.ENSMUSP00000039600    CCL5  Chemokine (C-C motif) ligand 5; Chemoattractan...      10090
  2101692  10090.ENSMUSP00000047646  CXCL10  Chemokine (C-X-C motif) ligand 10; In addition...      10090
  1848754      9606.ENSP00000305651  CXCL10  Chemokine (C-X-C motif) ligand 10; Chemotactic...       9606
  ...

  [edges]
   source   target score
  1847396  1847342   997
  2100220  2101692   995
  1847396  1848754   994
  1847396  1848852   994
  1847396  1862185   994
  ...
</code></pre></div>    </div>
  </li>
</ul>

<p><strong>Proteins</strong></p>

<ul>
  <li>
    <p>Expected RETURN format</p>

    <table>
      <thead>
        <tr>
          <th>Column name</th>
          <th>Type</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>protein</td>
          <td>Protein</td>
        </tr>
      </tbody>
    </table>
  </li>
  <li>
    <p>Output tables:</p>

    <table>
      <thead>
        <tr>
          <th>nodes</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>id</td>
        </tr>
        <tr>
          <td>external_id</td>
        </tr>
        <tr>
          <td>name</td>
        </tr>
        <tr>
          <td>description</td>
        </tr>
        <tr>
          <td>species_id</td>
        </tr>
      </tbody>
    </table>
  </li>
  <li>
    <p>Example:</p>

    <p>Proteins in Chemokine signaling pathway (for mouse)</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  WITH "Chemokine signaling pathway" as pathway_name,
  10090 as species_id
  MATCH (:Pathway {
      name: pathway_name,
      species_id: species_id
  }
  )&lt;-[:IN]-(protein:Protein)
  RETURN protein
</code></pre></div>    </div>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  [nodes]
       id               external_id    name                                        description species_id
  2111516  10090.ENSMUSP00000106906    NCF1  Neutrophil cytosolic factor 1; NCF2, NCF1, and...      10090
  2098897  10090.ENSMUSP00000033827    GRK1  G protein-coupled receptor kinase 1; Retina-sp...      10090
  2096411  10090.ENSMUSP00000025791  ADRBK1  Adrenergic receptor kinase, beta 1; Specifical...      10090
  2105346  10090.ENSMUSP00000070445  ADRBK2  Adrenergic receptor kinase, beta 2; Specifical...      10090
  2093189  10090.ENSMUSP00000001112    GRK4  G protein-coupled receptor kinase 4; Specifica...      10090
  ...
</code></pre></div>    </div>
  </li>
</ul>

<p><strong>Pathways</strong></p>

<ul>
  <li>
    <p>Expected RETURN format</p>

    <table>
      <thead>
        <tr>
          <th>Column name</th>
          <th>Type</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>pathway</td>
          <td>Pathway</td>
        </tr>
      </tbody>
    </table>
  </li>
  <li>
    <p>Output tables:</p>

    <table>
      <thead>
        <tr>
          <th>nodes</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>id</td>
        </tr>
        <tr>
          <td>name</td>
        </tr>
        <tr>
          <td>description</td>
        </tr>
        <tr>
          <td>species_id</td>
        </tr>
      </tbody>
    </table>
  </li>
  <li>
    <p>Example:</p>

    <p>Pathways associated with a protein list (for human)</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  WITH ["SFPI1", "FOSB"] as protein_names
  MATCH (protein:Protein {species_id: 9606})-[:IN]-&gt;(pathway:Pathway)
  WHERE protein.name IN protein_names
  RETURN pathway
</code></pre></div>    </div>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  [nodes]
             id                        name                                        description species_id
  path:hsa05034                  Alcoholism  Alcoholism, also called dependence on alcohol ...       9606
  path:hsa05031       Amphetamine addiction  Amphetamine is a psychostimulant drug that exe...       9606
  path:hsa05030           Cocaine addiction  Drug addiction is a chronic, relapsing disorde...       9606
  path:hsa04657     IL-17 signaling pathway  The interleukin 17 (IL-17) family, a subset of...       9606
  path:hsa04380  Osteoclast differentiation  The osteoclasts, multinucleared cells originat...       9606
</code></pre></div>    </div>
  </li>
</ul>

<p><strong>Drugs, compounds &amp; diseases</strong></p>

<ul>
  <li>
    <p>Expected RETURN format</p>

    <table>
      <thead>
        <tr>
          <th>Column name</th>
          <th>Type</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>drug</td>
          <td>Drug</td>
        </tr>
        <tr>
          <td>compound</td>
          <td>Compound</td>
        </tr>
        <tr>
          <td>disease</td>
          <td>Disease</td>
        </tr>
      </tbody>
    </table>
  </li>
  <li>
    <p>Output tables:</p>

    <table>
      <thead>
        <tr>
          <th>drugs</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>id</td>
        </tr>
        <tr>
          <td>name</td>
        </tr>
      </tbody>
    </table>

    <table>
      <thead>
        <tr>
          <th>compounds</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>id</td>
        </tr>
        <tr>
          <td>name</td>
        </tr>
      </tbody>
    </table>

    <table>
      <thead>
        <tr>
          <th>diseases</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>id</td>
        </tr>
        <tr>
          <td>name</td>
        </tr>
      </tbody>
    </table>
  </li>
  <li>
    <p>Example:</p>

    <p>Diseases associated with a protein list</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  WITH ["SFPI1", "FOSB"] as protein_names
  MATCH (protein:Protein)-[:IN]-&gt;(:Pathway)&lt;-[:IN]-(disease:Disease)
  WHERE protein.name IN protein_names
  RETURN disease
</code></pre></div>    </div>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  [diseases]
      id                           name
  H01611             Alcohol dependence
  H02042  Familial expansile osteolysis
  H01593                   Osteoporosis
  H00436                  Osteopetrosis
  H00437          Paget disease of bone
</code></pre></div>    </div>
  </li>
</ul>

<h1 id="more-advanced-cypher-queries">More advanced Cypher queries</h1>

<ul>
  <li>
    <p>Centrality for a protein list (with a score threshold of 0.7)</p>

    <p>Each <code class="highlighter-rouge">ASSOCIATION</code> relationship (edge) contains scores for different channels. <code class="highlighter-rouge">combined</code> score is always present and we use it to filter out insignificant interactions.</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  WITH ["SFPI1", "FOSB", "MLXIPL"] as protein_names,
       9606 as species_id,
       700 as threshold
  MATCH (p1:Protein {species_id: species_id})-[a:ASSOCIATION]-(p2:Protein)
  WHERE p1.name IN protein_names AND
        p2.name IN protein_names AND
        p1.id &lt;&gt; p2.id AND
        a.combined &gt;= threshold
  RETURN p1.name AS name, SUM(SIZE((p1)-[a]-(p2))) AS degree
  ORDER BY degree DESC
</code></pre></div>    </div>
  </li>
  <li>
    <p>Class hierarchy for a given pathway</p>

    <p>In this query, <code class="highlighter-rouge">chain</code> variable binds the whole pathway-class path in the graph.</p>

    <p><code class="highlighter-rouge">*</code> in <code class="highlighter-rouge">-[:IN*]-&gt;</code> specifies a variable number of <code class="highlighter-rouge">IN</code> relationships between protein and class nodes. <code class="highlighter-rouge">RELATIONSHIPS()</code> function is used to collect those edges.</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  WITH "Chemokine signaling pathway" AS pathway_name,
        9606 AS species_id
  MATCH chain = (pathway:Pathway {
          name: pathway_name,
          species_id: species_id
      }
  )-[:IN*]-&gt;(class:Class)
  RETURN pathway, class, RELATIONSHIPS(chain)
</code></pre></div>    </div>
  </li>
</ul>

  </div>

</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/protein-graph-database/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Protein Graph Database</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Borna Bešić</li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/bornabesic"><svg class="svg-icon"><use xlink:href="/protein-graph-database/assets/minima-social-icons.svg#github"></use></svg> <span class="username">bornabesic</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p></p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
